## Bayesian inference of the carbon homeostasis model parameters using starch and sucrose time-series data


Aim of this study is to assess the genes involved in the regulation of starch metabolism by integrating the mathematical modeling and mutant experiments of Arabidopsis plants. We adopted the carbon homeostasis model and estimated the model parameters using the time-series data of the starch and sucrose content in leaf tissues obtained from the wild-type and 13 mutants. Following souce codes provide the parameter estimation based on the Bayesian inference using the dataset `dataset.csv`.

### Workflow
1. Parameter estimation of the wild-type using `fitting_wt.R`
2. Parameter estimation of the mutant using `fitting_mt.R`
3. Extraction of parameter samples from stan sampling file using `parameter_sample.R`
4. Calculation of the posterior distribution of the model prediction from parameter samples using `posterior_prediction.R`
5. Creating a summary table of the posterior estimates using `posterior_summary.R`
6. Visualization

### Code description
#### Parameter estimation using the wild-type data
- `fitting_wt.R`  
  This code provides the Bayesian inference of wild-type data in `dataset.csv`. It processes the rawdata,  executes a stan code `fitting_wt.stan`, and checks the convergence of the MCMC samples.
- `fitting_wt.stan`  
  This stan code defines the core processes of the Bayesian inference, such as the numerical solvor of the model ODEs and the calculation of the likelihoods.


#### Parameter estimation using the the mutant data
- `fitting_mt.R`  
  This code executes the Bayesian inference and the model selection for each mutant. For each mutant, the parameter estimation is done using all the stan files in `/mutant_models_stan` directory, which defines every combination of the model parameters. It returns the MCMC samples of each model and its WAIC for each mutant.
- `mutant_models_stan/fitting_mt_modelX-XX.stan`  
  This stan code defines the core process of the Bayesian inference. Each code has a different combination of the parameters estimated. The file name X-XX indicates the model ID and the ID is listed in `model_list.csv`

#### Processing for the visualization and summarizing the result
- `parameter_sample.R`  
  This code extract the MCMC samples of the parameters as a matrix for the reduction of the data size and the easy handling of the sampling data.
- `posterior_prediction.R`  
This code generates the MCMC samples of the model prediction, which approximates the posterior distribution of the prediction, from the MCMC samples of the parameters processed with `parameter_sample.R`.
- `posterior_summary.R`
This code calculates the posterior estimates of each parameter for each genotype and returns it as a summary table.

#### Visualization of the result  
- `plot_posterior_distribution_wt.R`
  This code visualizes the posterior distribution of wild-type paramreters. Fig.2B in the paper is drawn by this.
- `plot_posterior_prediction_wt.R`  
  This code visualizes the posterior distribution of model prediction of the wild-type. Fig.2A and Fig.3 in the paper are drawn by this.
- `plot_parameter_comparison_mt.R`  
  This code visualizes the log 2 fold change of the posterior estimates of the model parameters (log2(mutant/wild-type)) and the deviation of the subjective photoperiod ΔτL. A heatmap Fig.4A and a scatter plot Fig.5A in the paper are generated by this.
- `plot_posterior_prediction_mt.R`  
  This code visualizes the posterior distribution of model prediction of each mutant with a control wild-type. Fig.4B and Fig.5B in the paper are drawn by this.
